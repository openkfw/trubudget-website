"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[76482],{3905:(t,e,a)=>{a.d(e,{Zo:()=>m,kt:()=>g});var n=a(67294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function i(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},l=Object.keys(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var s=n.createContext({}),d=function(t){var e=n.useContext(s),a=e;return t&&(a="function"==typeof t?t(e):o(o({},e),t)),a},m=function(t){var e=d(t.components);return n.createElement(s.Provider,{value:e},t.children)},u="mdxType",p={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},k=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,l=t.originalType,s=t.parentName,m=i(t,["components","mdxType","originalType","parentName"]),u=d(a),k=r,g=u["".concat(s,".").concat(k)]||u[k]||p[k]||l;return a?n.createElement(g,o(o({ref:e},m),{},{components:a})):n.createElement(g,o({ref:e},m))}));function g(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=a.length,o=new Array(l);o[0]=k;var i={};for(var s in e)hasOwnProperty.call(e,s)&&(i[s]=e[s]);i.originalType=t,i[u]="string"==typeof t?t:r,o[1]=i;for(var d=2;d<l;d++)o[d]=a[d];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},2865:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>s,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>d});var n=a(87462),r=(a(67294),a(3905));const l={sidebar_position:4},o="Load and stress tests",i={unversionedId:"developer/load-tests",id:"developer/load-tests",title:"Load and stress tests",description:"TruBudget uses load and stress tests to ensure the system's stability. Some tests are triggered automatically after a major release, others run on each push to the remote repository or get triggered manually. The automated testing strategy allows to regularly check the system minimal requirements and adjust them as needed. Furthermore, developer get detailed information about the system allowing to search for flaws i.e. bottlenecks.",source:"@site/docs/developer/load-tests.md",sourceDirName:"developer",slug:"/developer/load-tests",permalink:"/docs/developer/load-tests",draft:!1,editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/developer/load-tests.md",tags:[],version:"current",lastUpdatedBy:"egdmrsy",lastUpdatedAt:1687782184,formattedLastUpdatedAt:"Jun 26, 2023",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Node Status",permalink:"/docs/developer/architecture/node-connection-info"},next:{title:"How to write documentation for TruBudget",permalink:"/docs/developer/documentation"}},s={},d=[],m={toc:d},u="wrapper";function p(t){let{components:e,...a}=t;return(0,r.kt)(u,(0,n.Z)({},m,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"load-and-stress-tests"},"Load and stress tests"),(0,r.kt)("p",null,"TruBudget uses load and stress tests to ensure the system's stability. Some tests are triggered automatically after a major release, others run on each push to the remote repository or get triggered manually. The automated testing strategy allows to regularly check the system minimal requirements and adjust them as needed. Furthermore, developer get detailed information about the system allowing to search for flaws i.e. bottlenecks."),(0,r.kt)("p",null,"There are three types of load/stress tests:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Stress test: Classic stress to bring the core part of the system (API/Blockchain) to their limits. Although the system capacities are entirely used, the system should not crash nor be unusable"),(0,r.kt)("li",{parentName:"ul"},"Smoke Tests: Smoke test are regular load-test, configured for minimal load. They are used for sanity checks."),(0,r.kt)("li",{parentName:"ul"},"Stability Test: The whole system and it's interconnecting services such as Email Service and Storage Service are tested. This test, in terms of requests and users per second, is set up similarly to the stress test.")),(0,r.kt)("p",null,"TruBudget uses ",(0,r.kt)("a",{parentName:"p",href:"https://k6.io"},"k6")," to define and run load and stability tests. Tests can be run both locally and using Docker. We highly recommend using docker since the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/openkfw/TruBudget/tree/main/api/loadtest/runTests.sh"},"provided script")," spins up a complete test setup including Grafana and Influx.\nHowever, if you choose to run the tests locally, ",(0,r.kt)("inlineCode",{parentName:"p"},"k6")," needs to be installed. An optional Grafana and Influx instance are not required, but recommended in order to analyze the data generated by the tests."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Per default, the test script will run a smoke test against your local TruBudget instance. However, if you want to test a remote instance, the target URL can be changed in ",(0,r.kt)("inlineCode",{parentName:"p"},"api/loadtest/k6-tests/script.js")," by modifying the ",(0,r.kt)("inlineCode",{parentName:"p"},"BASE_URL")," constant.\nThe test type can be changed in the provided script (",(0,r.kt)("inlineCode",{parentName:"p"},"api/loadtest/runTests.sh"),") by modifying the ",(0,r.kt)("inlineCode",{parentName:"p"}," --config")," parameter. Valid options are:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"smoke.config.json"),": runs a smoke-test (1 virtual user)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"load.config.json"),": runs a load-test (100 virtual user)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"stress.config.json"),": runs a stress-test (400 virtual user)"))),(0,r.kt)("h1",{id:"getting-started"},"Getting started"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Navigate to ",(0,r.kt)("inlineCode",{parentName:"li"},"api/loadtest")),(0,r.kt)("li",{parentName:"ol"},"Configure the test as described above and add execution rights to ",(0,r.kt)("inlineCode",{parentName:"li"},"runTests.sh")),(0,r.kt)("li",{parentName:"ol"},"Run ",(0,r.kt)("inlineCode",{parentName:"li"},"./runTests.sh"))),(0,r.kt)("h1",{id:"visualizing"},"Visualizing"),(0,r.kt)("p",null,"To visualize the generated data from the tests via Grafana:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Open Grafana"),(0,r.kt)("li",{parentName:"ul"},"Navigate to Dashboard"),(0,r.kt)("li",{parentName:"ul"},"In the left sidebar, click the + button > Import"),(0,r.kt)("li",{parentName:"ul"},"Paste the Dashboard ID: 2587 or 11837"),(0,r.kt)("li",{parentName:"ul"},"Click Load"),(0,r.kt)("li",{parentName:"ul"},"Select the Influx data-source"),(0,r.kt)("li",{parentName:"ul"},"Click Import")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Grafana has a bunch of pre-configured dashboards for ",(0,r.kt)("inlineCode",{parentName:"p"},"k6")," we recommend using one of the two predefined dashboards (2587 or 11837) mentioned above. However, if you want to browse the available dashboards, you can do it ",(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/grafana/dashboards?search=k6"},"here"),". Also, feel free to contribute to the Grafana community by creating your own dashboard and publishing it to the Grafana Hub.")),(0,r.kt)("h1",{id:"minimum-requirements"},"Minimum requirements"),(0,r.kt)("p",null,"TruBudget can be deployed in different ways. To give your users the best experience, we tested TruBudget with different configurations. The minimum requirements aim to provide a working environment with 50 to 100 parallel user. The recommended environment is capable of handling 100 - 400 parallel user (using Kubernetes)."),(0,r.kt)("p",null,"If you plan to deploy TruBudget on a single VM with following services: Blockchain, API and Frontend, we recommend the following for minimum setup:\n| | Minimum |\n| ------- | ------- |\n| CPU\u2020 | 2 vCPU |\n| RAM | 8 GB |\n| Storage | 10 GB |"),(0,r.kt)("p",null,"If you plan to have more than 100 parallel users, we strongly recommend using Kubernetes. TruBudget load and stress tests are run against the minimum and recommend system requirements in a Kubernetes environment to ensure the correctness of the data below."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Blockchain"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Minimum"),(0,r.kt)("th",{parentName:"tr",align:null},"Recommended"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CPU\u2020"),(0,r.kt)("td",{parentName:"tr",align:null},"1 vCPU"),(0,r.kt)("td",{parentName:"tr",align:null},"2 vCPU")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RAM"),(0,r.kt)("td",{parentName:"tr",align:null},"4 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"8 GB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Storage"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"1","*"," GB")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Frontend"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Minimum"),(0,r.kt)("th",{parentName:"tr",align:null},"Recommended"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CPU\u2020"),(0,r.kt)("td",{parentName:"tr",align:null},"0.5 vCPU"),(0,r.kt)("td",{parentName:"tr",align:null},"1 vCPU")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RAM"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"2 GB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Storage"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"API"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Minimum"),(0,r.kt)("th",{parentName:"tr",align:null},"Recommended"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CPU\u2020"),(0,r.kt)("td",{parentName:"tr",align:null},"0.5 vCPU"),(0,r.kt)("td",{parentName:"tr",align:null},"1 vCPU")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RAM"),(0,r.kt)("td",{parentName:"tr",align:null},"2 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"8 GB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Storage"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Export-Service"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Minimum"),(0,r.kt)("th",{parentName:"tr",align:null},"Recommended"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CPU\u2020"),(0,r.kt)("td",{parentName:"tr",align:null},"0.5 vCPU"),(0,r.kt)("td",{parentName:"tr",align:null},"0.5 vCPU")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RAM"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Storage"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Email-Service"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Minimum"),(0,r.kt)("th",{parentName:"tr",align:null},"Recommended"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CPU\u2020"),(0,r.kt)("td",{parentName:"tr",align:null},"0.5 vCPU"),(0,r.kt)("td",{parentName:"tr",align:null},"0.5 vCPU")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RAM"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Storage"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Storage-Service"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Minimum"),(0,r.kt)("th",{parentName:"tr",align:null},"Recommended"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CPU\u2020"),(0,r.kt)("td",{parentName:"tr",align:null},"1 vCPU"),(0,r.kt)("td",{parentName:"tr",align:null},"2 vCPU")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RAM"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"2 GB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Storage"),(0,r.kt)("td",{parentName:"tr",align:null},"1 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"50","*"," GB")))),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"\u2020 Depending on your or your provider's infrastructure, the strength of one virtual CPU might vary. The above values are based on the Intel\xae Xeon\xae Platinum 8272CL processor (second generation Intel\xae Xeon\xae Scalable processors), Intel\xae Xeon\xae 8171M 2.1GHz (Skylake), Intel\xae Xeon\xae E5-2673 v4 2.3 GHz (Broadwell), or the Intel\xae Xeon\xae E5-2673 v3 2.4 GHz (Haswell) processors."),(0,r.kt)("p",{parentName:"admonition"},"*"," Assuming you are using off-chain-storage.")))}p.isMDXComponent=!0}}]);