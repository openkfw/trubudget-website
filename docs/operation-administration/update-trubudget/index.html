<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-operation-administration/update-trubudget">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Updating TruBudget | TruBudget</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://trubudget.net/docs/operation-administration/update-trubudget"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Updating TruBudget | TruBudget"><meta data-rh="true" name="description" content="This guide shows three different possibilities how to safely update your Trubudget without any loss of data. Especially the wallet address and the node&#x27;s private keys need to be remembered, so that the node can be identified within the network and doesn&#x27;t need to ask for connect permissions again after the update. The wallet address and private keys are stored in the wallet.dat file located in the root folder of a multichain node."><meta data-rh="true" property="og:description" content="This guide shows three different possibilities how to safely update your Trubudget without any loss of data. Especially the wallet address and the node&#x27;s private keys need to be remembered, so that the node can be identified within the network and doesn&#x27;t need to ask for connect permissions again after the update. The wallet address and private keys are stored in the wallet.dat file located in the root folder of a multichain node."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://trubudget.net/docs/operation-administration/update-trubudget"><link data-rh="true" rel="alternate" href="https://trubudget.net/docs/operation-administration/update-trubudget" hreflang="en"><link data-rh="true" rel="alternate" href="https://trubudget.net/docs/operation-administration/update-trubudget" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c6419447.css">
<link rel="preload" href="/assets/js/runtime~main.062bb8ed.js" as="script">
<link rel="preload" href="/assets/js/main.3891b7c6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">TruBudget</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Documentation</a><a href="https://github.com/openkfw/TruBudget/discussions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://taas.trubudget.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">TruBudget as a Service<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openkfw/TruBudget" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/usecases">Example Use Cases</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/developer/introduction">Developer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/operation-administration/introduction">Operation / Administration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/operation-administration/introduction">Introduction and Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/operation-administration/security">Security @ TruBudget</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/operation-administration/installation/">Installation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Installation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/operation-administration/architecture">Architecture in TruBudget</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/operation-administration/debugging">Debugging TruBudget</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/operation-administration/encryption">Securing communication between nodes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/operation-administration/logging-monitoring">Logging and Monitoring in TruBudget</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/operation-administration/multichain-cli">Multichain-Cli</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/operation-administration/resource-requirements">Running TruBudget</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/operation-administration/update-trubudget">Updating TruBudget</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/user-guide/">User-Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;User-Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/known-issues/intro">Known Issues</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/environment-variables">Environment Variables</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Operation / Administration</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Updating TruBudget</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Updating TruBudget</h1><p>This guide shows three different possibilities how to safely update your Trubudget without any loss of data. Especially the wallet address and the node&#x27;s private keys need to be remembered, so that the node can be identified within the network and doesn&#x27;t need to ask for connect permissions again after the update. The wallet address and private keys are stored in the <code>wallet.dat</code> file located in the root folder of a multichain node.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents">​</a></h2><ul><li><a href="#updating-trubudget">Updating TruBudget</a><ul><li><a href="#version-update">Version update</a><ul><li><a href="#minor-version">Minor version</a></li><li><a href="#update-from-version-1x-to-2x">Update from version 1.x to 2.x</a></li></ul></li><li><a href="#backup-and-restore">Backup and restore</a><ul><li><a href="#full-state-backup">Full state backup</a></li><li><a href="#full-state-backup-via-backup-feature">Full state backup via backup feature</a></li><li><a href="#wallet-backup">Wallet backup</a><ul><li><a href="#walletdat">wallet.dat</a></li><li><a href="#paramsdat">params.dat</a></li><li><a href="#multichainconf">multichain.conf</a></li></ul></li><li><a href="#hints-and-pitfalls">Hints and Pitfalls</a></li></ul></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="version-update">Version update<a href="#version-update" class="hash-link" aria-label="Direct link to Version update" title="Direct link to Version update">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="minor-version">Minor version<a href="#minor-version" class="hash-link" aria-label="Direct link to Minor version" title="Direct link to Minor version">​</a></h3><p>In order to do the minor update of TruBudget e.g. from 2.0.0 to version 2.1.0 you are required to do several steps.</p><ol><li>Make sure the multichain data and other persistent data is saved. The recommended option is to use volumes to persist TruBudget data. This option mounts a volume into the container depending on your infrastructure you can use docker volumes (docker compose setup) or persistent volumes (kubernetes). If the data is not saved - <a href="#backup-and-restore">do a backup</a>.</li><li>Update the version used in the deployment. Use a specific release published on <a href="https://hub.docker.com/u/trubudget" target="_blank" rel="noopener noreferrer">docker-hub</a>. </li><li>Check the changelog file for changes. All bigger modifications to the system which are relevant to the user are added to the CHANGELOG.md.
After checking the changelog verify if additional actions are needed to enable new features. </li><li>Restart TruBudget.</li><li>(Optional) Check the status page in the TruBudget UI if all components use the correct version.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="update-from-version-1x-to-2x">Update from version 1.x to 2.x<a href="#update-from-version-1x-to-2x" class="hash-link" aria-label="Direct link to Update from version 1.x to 2.x" title="Direct link to Update from version 1.x to 2.x">​</a></h3><p>In TruBudget 2.0.0, the Test and Prod Environment has been removed in <a href="https://github.com/openkfw/TruBudget/issues/954" target="_blank" rel="noopener noreferrer">#954</a>. This means the DropDown menu to select Prod and Test at the Login-page is removed and the frontend and excel-export-service is only connected to one API and one Blockchain. If you want to update TruBudget 2.0.0 or higher from version 1.30.0 or lower, you must re-set some new <code>env</code> vars for your setup. If you want to use 2 Environments, you need to setup an additional Frontend with another URL and connect it to another API.</p><table><thead><tr><th>Removed <code>env</code> vars</th><th>Description</th></tr></thead><tbody><tr><td>API_TEST_HOST</td><td>Host address of API for Test environment</td></tr><tr><td>API_TEST_PORT</td><td>Port of API for Test environment</td></tr><tr><td>API_PROD_HOST</td><td>Host address of API for Prod environment</td></tr><tr><td>API_PROD_PORT</td><td>Port of API for Prod environment</td></tr></tbody></table><table><thead><tr><th>New <code>env</code> vars</th><th>Description</th></tr></thead><tbody><tr><td>API_HOST</td><td>Host address of API that should be used</td></tr><tr><td>API_PORT</td><td>Port of API that should be used</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>If you want keep Prod and Test environment, you need to setup an additional Frontend with another URL and connect one to Test-API and one to Prod-API.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="backup-and-restore">Backup and restore<a href="#backup-and-restore" class="hash-link" aria-label="Direct link to Backup and restore" title="Direct link to Backup and restore">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-state-backup">Full state backup<a href="#full-state-backup" class="hash-link" aria-label="Direct link to Full state backup" title="Direct link to Full state backup">​</a></h3><p>The full state of a node and all its configuration parameters is saved in the node&#x27;s blockchain directory (e.g. <code>[PathToMultichainData]/.multichain/TrubudgetChain/</code>). When backing up the full state of your node, it is required to stop the container first, otherwise the consistency of the backed-up files cannot be ensured.</p><ol><li>Stop the multichain daemon of the node you want to update</li><li>Copy the whole chain folder (e.g. <code>TrubudgetChain</code>) located in the .multichain folder of the node</li><li>[Optional]<!-- --> Update Trubudget</li><li>Put the copied chain folder in the .multichain folder of the new or updated node</li><li>Start the multichain daemon again so it can connect with its old wallet address/private keys</li></ol><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><ul><li>Note that a node which is started after an update but before replacing the chain folder, the node will ask for permission to connect to the network since it received a new wallet address.</li><li>If the Trubudget blockchain is running with docker there is currently no way to replace the folder before starting. The network will receive a network access request and currently it cannot be removed from the request stack.</li><li>Make sure the multichain folder especially the wallet.dat file is deleted or securely saved afterwards since it contains the node&#x27;s private keys and wallet address.</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-state-backup-via-backup-feature">Full state backup via backup feature<a href="#full-state-backup-via-backup-feature" class="hash-link" aria-label="Direct link to Full state backup via backup feature" title="Direct link to Full state backup via backup feature">​</a></h3><p>TruBudget provides a backup endpoint that allows to perform a backup via the frontend. For a detailed explanation how to create/restore a backup via the frontend check out this guide <a href="/docs/user-guide/backup">Create/Restore a Backup</a>.</p><ol><li>Log into Trubudget&#x27;s frontend with the root user</li><li>Click the backup download button in the side navigation bar</li><li>Caution: The downloaded backup.gz file can be used to restore the Trubudget node&#x27;s state again including wallet address and private keys, so be careful.</li><li>Stop the node</li><li>Update the node to a newer version</li><li>Start the node again</li><li>Log into Trubudget&#x27;s frontend with the root user</li><li>Click the backup restore button in the side navigation bar and provide the backup.gz file</li><li>After a successful restore the root user is logged out automatically</li></ol><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><ul><li>Only the root user can download/restore a backup via frontend/api.</li><li>Note that a node which is started after an update but before replacing the chain folder, the node will ask for permission to connect to the network since it received a new wallet address.</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wallet-backup">Wallet backup<a href="#wallet-backup" class="hash-link" aria-label="Direct link to Wallet backup" title="Direct link to Wallet backup">​</a></h3><p>It is possible to perform a backup only of the wallet.dat file. Thus it is not necessary to stop the node and the size of the backed-up data is considerably smaller. The wallet.dat is stored in a node&#x27;s blockchain directory <code>[PathToMultichainData]/.multichain/TrubudgetChain/</code>.</p><ol><li>Copy the wallet.dat file located in a node&#x27;s blockchain directory</li><li>Obtain a another node&#x27;s address</li><li>Delete the node&#x27;s blockchain directory</li><li>[Optional]<!-- --> Update TruBudget</li><li>Start to connect to the network using the previously obtained node address</li><li>Replace the newly created wallet.dat file with the backed-up version of the wallet.dat file</li><li>Start the multichain daemon again and connect to the network</li><li>Delete the copy of the wallet.dat file</li></ol><p><strong>Hints</strong></p><ul><li>MultiChain provides the API command <code>backupwallet</code> to directly back up the wallet.dat file but it won&#x27;t work with the TrubudgetChain, so it is required to copy the file manually.</li><li>Note that after the update a node asks for permission to connect again until the wallet.dat file is replaced since it received a new wallet address.</li><li>Make sure the multichain folder especially the wallet.dat file is deleted or securely saved afterwards since it contains the node&#x27;s private keys and wallet address.</li></ul><p>For further information how to back up and restore a node check out the MultiChain Website: <a href="https://www.multichain.com/developers/backing-up-restoring-nodes/" target="_blank" rel="noopener noreferrer">Backing Up and Restoring Nodes</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="walletdat">wallet.dat<a href="#walletdat" class="hash-link" aria-label="Direct link to wallet.dat" title="Direct link to wallet.dat">​</a></h4><p>In the wallet.dat file the wallet address and the private key of a node&#x27;s wallet is stored. Based on a node&#x27;s address it will be granted access by the alpha node. The node is then identified and remembered by its wallet address within the network. Since it&#x27;s a node&#x27;s identification it has to be kept confidential and should not be shared with any third party.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="paramsdat">params.dat<a href="#paramsdat" class="hash-link" aria-label="Direct link to params.dat" title="Direct link to params.dat">​</a></h4><p>In the params.dat file all basic chain parameters are stored. The parameters configure the blockchain and can be modified before the blockchain is initialized. A node&#x27;s parameters can be retrieved using the <code>getblockchainparams</code> API command.</p><p>A full list of the blockhain&#x27;s parameters can be found on the MultiChain Website: <a href="https://www.multichain.com/developers/blockchain-parameters/" target="_blank" rel="noopener noreferrer">Blockchain Parameters</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="multichainconf">multichain.conf<a href="#multichainconf" class="hash-link" aria-label="Direct link to multichain.conf" title="Direct link to multichain.conf">​</a></h4><p>MultiChain creates two multichain.conf files. One is stored in the MultiChain&#x27;s directory <code>[PathToMultichainData]/.multichain</code> and the other one inside of the TrubudgetChain&#x27;s directory <code>[PathToMultichainData]/.multichain/TrubudgetChain</code>. Both contain basic configuration parameters like the RPC Port, the RPC User, the RPC Password and the RPC Allow IP. The first multichain.conf file is created when the blockchain is set up. The second one is created when the node is initialized.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hints-and-pitfalls">Hints and Pitfalls<a href="#hints-and-pitfalls" class="hash-link" aria-label="Direct link to Hints and Pitfalls" title="Direct link to Hints and Pitfalls">​</a></h3><p>A downloaded backup might sometimes be saved with an invalid hash. When trying to restore the backup using this corrupted .gz file, the error shown below might occur.</p><p><img loading="lazy" alt="restore backup failed" src="/assets/images/failed_restore_error-158bc4de255e3e2b9fa8f510a9bf6f60.jpeg" width="2211" height="1657" class="img_ev3q"></p><p>If this error occurs and you are certain that the <code>backup.gz</code> compressed folder you want to upload is indeed a valid TruBudget backup, you can run a script that will fix the invalid hash, in order to sucessfully restore the backup.</p><ol><li>Navigate to the <code>/blockchain</code> folder and open your favorite shell</li><li>Type <code>npm run check_backup</code> and add the path to the backup.gz file you want to fix (e.g. <code>npm run check_backup -- &quot;path/to/backup.gz&quot;</code>)</li><li>The script will print out the result of the check which tells you if the backup is valid or not.</li><li>Optionally, type -f/--fix after the path. This option will also fix the hash if it is invalid. A new file <code>backup updated.gz</code> will be created in the same location as the one you provided. It is an exact copy of your backup, but with a corrected hash</li><li>You can now use this file to restore your backup</li></ol><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>If your filename contains a blank space (e.g. <code>backup (1).gz</code>), you should use quotation marks when entering the path, so it will be recognized as one argument and not two separate ones.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/operation-administration/update-trubudget.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-10-13T11:21:38.000Z">Oct 13, 2023</time></b> by <b>Georgia Moldovan</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/operation-administration/resource-requirements"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Running TruBudget</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/user-guide/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#version-update" class="table-of-contents__link toc-highlight">Version update</a><ul><li><a href="#minor-version" class="table-of-contents__link toc-highlight">Minor version</a></li><li><a href="#update-from-version-1x-to-2x" class="table-of-contents__link toc-highlight">Update from version 1.x to 2.x</a></li></ul></li><li><a href="#backup-and-restore" class="table-of-contents__link toc-highlight">Backup and restore</a><ul><li><a href="#full-state-backup" class="table-of-contents__link toc-highlight">Full state backup</a></li><li><a href="#full-state-backup-via-backup-feature" class="table-of-contents__link toc-highlight">Full state backup via backup feature</a></li><li><a href="#wallet-backup" class="table-of-contents__link toc-highlight">Wallet backup</a></li><li><a href="#hints-and-pitfalls" class="table-of-contents__link toc-highlight">Hints and Pitfalls</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/README">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openkfw/TruBudget/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openkfw/TruBudget" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://taas.trubudget.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">TruBudget as a Service<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 TruBudget</div></div></div></footer></div>
<script src="/assets/js/runtime~main.062bb8ed.js"></script>
<script src="/assets/js/main.3891b7c6.js"></script>
</body>
</html>